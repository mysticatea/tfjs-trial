(window.webpackJsonp=window.webpackJsonp||[]).push([[7,8,9],{152:function(t,e,n){},153:function(t,e,n){},157:function(t,e,n){"use strict";var i=n(185);const o=1e-4,s=64,r=[4,4],a=4;class l{constructor(t,e){if(this.dimension=t,this.model=function({stateSize:t,actionSize:e}){const n=i.input({name:"INPUT",shape:t,dtype:"float32"}),l=function(t){let e=h(t,u(s,r),i.layers.batchNormalization({axis:1}),i.layers.activation({activation:"relu"}));for(let t=0;t<a;++t)e=c(e);return e}(n),d=function(t){const e=i.layers.dense({units:1,useBias:!1,activation:"tanh",kernelRegularizer:i.regularizers.l2({l2:o})});return h(t,u(1,[1,1]),i.layers.batchNormalization({axis:1}),i.layers.activation({activation:"relu"}),i.layers.flatten(),i.layers.dense({units:20,useBias:!1,activation:"linear",kernelRegularizer:i.regularizers.l2({l2:o})}),i.layers.activation({activation:"relu"}),e),e.output}(l),f=function(t,e){const n=i.layers.dense({units:e,useBias:!1,activation:"linear",kernelRegularizer:i.regularizers.l2({l2:o})});return h(t,u(2,[1,1]),i.layers.batchNormalization({axis:1}),i.layers.activation({activation:"relu"}),i.layers.flatten(),n),n.output}(l,e),g=i.model({inputs:[n],outputs:[d,f]});return g.compile({optimizer:"sgd",loss:["meanSquaredError","meanSquaredError"]}),g.lossFunctions[1]=i.losses.softmaxCrossEntropy,g}(t),e){const t=JSON.parse(e).weights.map(t=>i.tensor(t.values,t.shape,t.dtype));this.model.setWeights(t)}}get inputSize(){const[t,e,n]=this.dimension.stateSize;return t*e*n}async predict(t,e){const[n,o]=i.tidy(()=>{const n=i.tensor4d(t,[e,...this.dimension.stateSize],"float32");return this.model.predictOnBatch(n)}),s=await n.data(),r=await o.data();n.dispose(),o.dispose();const a=new Array(e),l=this.dimension.actionSize;for(let t=0;t<e;++t){const e=s[t],n=new Float32Array(r.buffer,r.byteOffset+4*t*l,l);a[t]={value:e,policy:n}}return a}async fit(t){const e=this.dimension;let n,o,s;try{return n=i.tensor4d(d(t,"state",e.stateSize[0]*e.stateSize[1]*e.stateSize[2]),[t.length,...e.stateSize],"float32"),o=i.tensor1d(function(t,e){const n=new Float32Array(t.length);for(let i=0;i<t.length;++i)n[i]=t[i][e];return n}(t,"value"),"float32"),s=i.tensor2d(d(t,"policy",e.actionSize),[t.length,e.actionSize],"float32"),await this.model.fit(n,[o,s])}finally{n&&n.dispose(),o&&o.dispose(),s&&s.dispose()}}serialize(){return i.tidy(()=>{const t=this.model.getWeights().map(t=>{return{values:Array.from(t.dataSync()),shape:t.shape,dtype:t.dtype}});return JSON.stringify({weights:t})})}}function c(t){let e=h(t,u(s,r),i.layers.batchNormalization({axis:1}),i.layers.activation({activation:"relu"}),u(s,r),i.layers.batchNormalization({axis:1}));return e=i.layers.add().apply([t,e]),e=i.layers.activation({activation:"relu"}).apply(e)}function u(t,e){return i.layers.conv2d({filters:t,kernelSize:e,dataFormat:"channelsFirst",padding:"same",useBias:!1,activation:"linear",kernelRegularizer:i.regularizers.l2({l2:o}),dtype:"float32"})}function h(t,...e){return e.reduce((t,e)=>e.apply(t),t)}function d(t,e,n){const i=new Float32Array(t.length*n);for(let o=0;o<t.length;++o){const s=t[o][e],r=o*n;for(let t=0;t<n;++t)i[r+t]=s[t]}return i}function f(t,e){const n=t.length;if(n<=e<<2)return function(t,e){const n=t.length,i=t.slice(0);for(let t=n<=e?n-1:e;t>0;--t){const e=Math.random()*n|0,o=i[t];i[t]=i[e],i[e]=o}n>e&&(i.length=e);return i}(t,e);const i=new Array(e),o=new Set;let s=0,r=0;for(;s<e;){do{r=Math.random()*n|0}while(o.has(r));o.add(r),i[s++]=t[r]}return i}const g=5;class p{constructor(t){this.nodes=new Map,this.rule=t,this.root=new p.Node(t.initialState),this.nodes.set(this.root.state.id,this.root)}changeRoot(t){const e=this.nodes.get(t.id);return e?this.root=e:(this.root=new p.Node(t),this.nodes.set(t.id,this.root)),this.root}getBestAction(){const t=new Float32Array(this.rule.actionSize),e=this.root.edges;let n=0,i=Number.MIN_SAFE_INTEGER;const o=[];for(const s of e)t[s.action]=s.n,n+=s.n,s.n>i&&(i=s.n,o.length=0),s.n===i&&o.push(s);for(let e=0;e<t.length;++e)t[e]/=n;const s=o.length,r=1===s?o[0]:o[Math.random()*s|0];return{state:r.outNode.state,action:r.action,value:r.q,policy:t}}getLeaves(t=1){return 0===this.root.edges.length?[{leaf:this.root,route:[]}]:f(this.root.edges,t).map(y).filter(m,new Set)}makeNextNodes(t,e,n){if(!0===t.done)throw new Error("duplicate makeNextNodes() call.");if(n.length!==t.state.actions.length)throw new Error("probs.length must be same as actions.length");t.value=e,t.done=!0;const i=t.state;for(let e=0,o=n.length;e<o;++e){const o=i.actions[e],s=n[e],r=this.rule.takeAction(i,o);let a=this.nodes.get(r.id);a||(a=new p.Node(r),this.nodes.set(r.id,a)),t.edges.push(new p.Edge(t,a,o,s))}}}function y(t){let e=t.outNode;const n=[t];for(;0!==e.edges.length;){const t=w(e);e=t.outNode,n.push(t)}return{leaf:e,route:n}}function m({leaf:t}){const e=t.state.id;return!this.has(e)&&(this.add(e),!0)}function w(t){const e=Math.sqrt(t.edges.reduce(v,0));let n,i=Number.NEGATIVE_INFINITY;for(const o of t.edges){const{n:t,q:s,prior:r}=o,a=s+g*r*e/(1+t);a>i&&(i=a,n=o)}return n}function v(t,e){return t+e.n}!function(t){t.Node=class{constructor(t){this.edges=[],this.value=0,this.done=!1,this.state=t}};t.Edge=class{constructor(t,e,n,i){this.n=0,this.w=0,this.q=0,this.inNode=t,this.outNode=e,this.action=n,this.prior=i}}}(p||(p={}));const b=8;class x{constructor({rule:t,serializedModel:e,maxThinkingTime:n={type:"count",value:10},onAct:i}){this.model=new l(t,e),this.mcts=new p(t),this.maxThinkingTime=n,this.onAct=i}reset(){this.mcts=new p(this.mcts.rule)}async act(t){if(this.mcts.changeRoot(t),"count"===this.maxThinkingTime.type)for(let t=this.maxThinkingTime.value;t>0;--t)await this.simulate();else{const t=Date.now()+this.maxThinkingTime.value;do{await this.simulate()}while(Date.now()<t)}const{state:e,action:n,value:i,policy:o}=this.mcts.getBestAction();if(this.onAct){const e=this.model.inputSize,s=new Float32Array(e);t.getStateData(s),this.onAct({state:s,action:n,value:i,policy:o})}return e}async simulate(){const t=this.mcts,e=t.getLeaves(b);if(0===e.length)return;const n=this.model.inputSize,i=new ArrayBuffer(4*n*e.length);for(let t=0;t<e.length;++t){const o=new Float32Array(i,4*t*n,n);e[t].leaf.state.getStateData(o)}const o=new Float32Array(i,0,n*e.length),s=await this.model.predict(o,e.length);for(let n=0;n<e.length;++n){const{leaf:i,route:o}=e[n],{value:r,policy:a}=s[n];if(!i.done){const e=i.state.actions,n=new Array(e.length);let o=0;for(let t=0;t<n.length;++t)o+=n[t]=Math.exp(a[e[t]]);for(let t=0;t<n.length;++t)n[t]/=o;t.makeNextNodes(i,r,n)}_(i,o)}}}function _(t,e){const n=t.state.playerTurn,i=t.value;for(const t of e){const e=t.inNode.state.playerTurn===n?1:-1;t.n=t.n+1,t.w=t.w+i*e,t.q=t.w/t.n}}class A{constructor(t){this.onAct=t}act(t){return new Promise((e,n)=>{this.onAct(t,e,n)})}}class T{constructor(t){this.rule=t}async play({players:t,signal:e,onThinkStart:n,onThinkEnd:i,onUpdate:o}){let s=this.rule.initialState,r=t[s.playerTurn];o&&(await o(s),k(e));do{n&&(await n(s,r),k(e)),s=await r.act(s),k(e),i&&(await i(s,r),k(e)),o&&(await o(s),k(e)),r=t[s.playerTurn]}while(s.actions.length>0);return s}}function k(t){if(t&&t.aborted)throw new Error("aborted")}class S{constructor(t){this.rule=t}async train({numPlayers:t=2,playingLoops:e=30,trainingLoops:n=30,trainingSample:i=256,scoreThreshold:o=.75,maxThinkingTime:s,initialSerializedModel:r,signal:a,onEpisodeBegin:l,onEpisodeEnd:c,onPlayBegin:u,onPlayEnd:h,onPlayStateChange:d,onTrainBegin:g,onTrainEnd:p}={}){const y=this.rule,m=new T(y),w=[],v=Array.from({length:t-1},()=>new x({rule:y,serializedModel:r,maxThinkingTime:s})),b=new x({rule:y,serializedModel:r,maxThinkingTime:s,onAct(t){w.push(t)}});for(let s=0;;++s){l&&(await l(s),z(a));let r=0;for(let n=0;n<e;++n){u&&(await u(s,n),z(a));const e=n%t,i=v.slice(0);i.splice(e,0,b);const o=await m.play({players:i,signal:a,onUpdate:d&&(t=>d(s,n,t))});z(a);const[l,c,f]=this.rule.stateSize,g=new Float32Array(l*c*f);o.getStateData(g),w.push({state:g,value:o.winner===e?1:-1,policy:new Float32Array(this.rule.actionSize)}),o.winner===e&&(r+=1),h&&(await h(s,n,r/(n+1)),z(a));for(const t of v)t.reset();b.reset()}if(s>=1&&r/e>=o)return{finalSerializedModel:b.model.serialize()};const c=b.model;for(let t=0;t<n;++t){const e=f(w,i);g&&(await g(s,t),z(a));const{epoch:n,history:o}=await c.fit(e);z(a),p&&(await p(s,t,n,o),z(a))}w.length=0}}}function z(t){if(t&&t.aborted)throw new Error("aborted")}n.d(e,"a",function(){return x}),n.d(e,!1,function(){return l}),n.d(e,"b",function(){return A}),n.d(e,"c",function(){return T}),n.d(e,"d",function(){return S})},158:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var i=n(1);function o(){return new Promise(t=>i.a.nextTick(()=>setTimeout(t,0)))}},166:function(t,e,n){"use strict";var i=n(19),o=n(193);i(i.P+i.F*n(192)("includes"),"String",{includes:function(t){return!!~o(this,t,"includes").indexOf(t,arguments.length>1?arguments[1]:void 0)}})},167:function(t,e,n){"use strict";var i=n(19),o=n(69)(!0);i(i.P,"Array",{includes:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),n(66)("includes")},168:function(t,e,n){"use strict";class i{constructor(t,e,n,i,o){this.id=t,this.playerTurn=e,this.winner=n,this.board=i,this.actions=o}getStateData(t){const e=this.playerTurn,n=1^e,i=this.board,o=i.length;for(let s=0;s<i.length;++s)switch(i[s]){case e:t[s]=1;break;case n:t[o+s]=1}}}const o=9,s=9,r=5,a=new Map,l=Object.freeze(new Array(o*s).fill(-1));class c{constructor(){this.stateSize=[2,o,s],this.actionSize=s*o,this.initialState=new i(function(t){let e="";for(let n=0;n<t.length;n+=2){const i=3&t[n],o=3&t[n+1];e+=(i<<2|o).toString(16)}return e}(l),0,-1,new Array(o*s).fill(-1),u(l)),this.rows=o,this.cols=s}takeAction(t,e){if(-1!==t.board[e])throw new Error("Invalid action");const n=function(t,e,n){const i=n/2|0,o=parseInt(t[i],16),s=((1&n?o>>2&3:3&e)<<2|(1&n?3&e:3&o)).toString(16);return`${t.slice(0,i)}${s}${t.slice(i+1)}`}(t.id,t.playerTurn,e);if(a.has(n))return a.get(n);const o=1^t.playerTurn,r=t.board.slice(0);r[e]=t.playerTurn;const l=function(t,e){return h(t,e,1)||h(t,e,s-1)||h(t,e,s)||h(t,e,s+1)}(r,e)?t.playerTurn:-1,c=-1!==l?[]:u(r),d=new i(n,o,l,r,c);return a.set(n,d),d}}function u(t){const e=[];for(let n=0;n<t.length;++n)-1===t[n]&&e.push(n);return e}function h(t,e,n){const i=t[e];let o=e-n;for(;o>=0&&t[o]===i;)o-=n;let s=e+n;for(;s<t.length&&t[s]===i;)s+=n;return(s-o)/n-1>=r}n.d(e,"a",function(){return d}),n.d(e,"b",function(){return f}),n.d(e,!1,function(){return c}),n.d(e,!1,function(){return i});const d=Object.freeze(new c),f=Object.freeze([void 0])},171:function(t,e,n){},183:function(t,e){},189:function(t,e,n){"use strict";var i=n(152);n.n(i).a},190:function(t,e,n){var i=n(8),o=Math.floor;t.exports=function(t){return!i(t)&&isFinite(t)&&o(t)===t}},191:function(t,e,n){var i=n(19);i(i.S,"Number",{isInteger:n(190)})},192:function(t,e,n){var i=n(2)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[i]=!1,!"/./"[t](e)}catch(t){}}return!0}},193:function(t,e,n){var i=n(68),o=n(42);t.exports=function(t,e,n){if(i(e))throw TypeError("String#"+n+" doesn't accept regex!");return String(o(t))}},194:function(t,e,n){"use strict";var i=n(153);n.n(i).a},195:function(t,e,n){"use strict";n.r(e);n(40),n(39);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var o={name:"AgentConfig",model:{prop:"config",event:"change"},props:{weights:{type:Array,default:function(){return[void 0]},validator:function(t){return t.length>=1}},config:{type:Object,default:function(){return{weights:void 0,depth:5}},validator:function(t){return!("object"!==i(t)||void 0!==t.manual&&"boolean"!=typeof t.manual||void 0!==t.weights&&"string"!=typeof t.weights||"number"!=typeof t.depth)}},noManual:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},data:function(){return{weightIndex:!this.noManual&&Boolean(this.config.manual)?-1:this.weights.indexOf(this.config.weights),depth:Number(this.config.depth)||5}},computed:{depthDisabled:function(){return this.disabled||-1===this.weightIndex}},watch:{config:function(t){var e=!this.noManual&&Boolean(t.manual);this.weightIndex=e?-1:this.weights.indexOf(t.weights),this.depth=t.depth},weightIndex:function(t){var e=this.noManual?void 0:-1==t,n=e?void 0:this.weights[t],i=this.depth;this.config.manual===e&&this.config.weights===n||this.$emit("change",{manual:e,weights:n,depth:i})},depth:function(t){var e=this.noManual?void 0:-1===this.weightIndex,n=e?void 0:this.weights[this.weightIndex],i=Number(t)||5;this.config.depth!==i&&this.$emit("change",{manual:e,weights:n,depth:i})}}},s=(n(194),n(0)),r=Object(s.a)(o,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"agent-config-root"},[n("select",{directives:[{name:"model",rawName:"v-model",value:t.weightIndex,expression:"weightIndex"}],attrs:{disabled:t.disabled},on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.weightIndex=e.target.multiple?n:n[0]}}},[t.noManual?t._e():n("option",{key:-1,attrs:{value:"-1"}},[t._v("マウスで入力")]),t._l(t.weights,function(e,i){return n("option",{key:i,domProps:{value:i}},[t._v("\n            第 "+t._s(i)+" 世代\n        ")])})],2),t._v("\n    |\n    "),n("label",[t._v("\n        先読みレベル\n        "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.depth,expression:"depth"}],attrs:{disabled:t.depthDisabled,type:"number",min:"1",max:"99"},domProps:{value:t.depth},on:{input:function(e){e.target.composing||(t.depth=e.target.value)}}})])])},[],!1,null,null,null);e.default=r.exports},197:function(t,e,n){"use strict";n.r(e);n(167),n(166),n(41),n(191);var i=Math.PI,o=2*i,s=o-1e-6;function r(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function a(){return new r}r.prototype=a.prototype={constructor:r,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,i){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+i)},bezierCurveTo:function(t,e,n,i,o,s){this._+="C"+ +t+","+ +e+","+ +n+","+ +i+","+(this._x1=+o)+","+(this._y1=+s)},arcTo:function(t,e,n,o,s){t=+t,e=+e,n=+n,o=+o,s=+s;var r=this._x1,a=this._y1,l=n-t,c=o-e,u=r-t,h=a-e,d=u*u+h*h;if(s<0)throw new Error("negative radius: "+s);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(d>1e-6)if(Math.abs(h*l-c*u)>1e-6&&s){var f=n-r,g=o-a,p=l*l+c*c,y=f*f+g*g,m=Math.sqrt(p),w=Math.sqrt(d),v=s*Math.tan((i-Math.acos((p+d-y)/(2*m*w)))/2),b=v/w,x=v/m;Math.abs(b-1)>1e-6&&(this._+="L"+(t+b*u)+","+(e+b*h)),this._+="A"+s+","+s+",0,0,"+ +(h*f>u*g)+","+(this._x1=t+x*l)+","+(this._y1=e+x*c)}else this._+="L"+(this._x1=t)+","+(this._y1=e);else;},arc:function(t,e,n,r,a,l){t=+t,e=+e;var c=(n=+n)*Math.cos(r),u=n*Math.sin(r),h=t+c,d=e+u,f=1^l,g=l?r-a:a-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+h+","+d:(Math.abs(this._x1-h)>1e-6||Math.abs(this._y1-d)>1e-6)&&(this._+="L"+h+","+d),n&&(g<0&&(g=g%o+o),g>s?this._+="A"+n+","+n+",0,1,"+f+","+(t-c)+","+(e-u)+"A"+n+","+n+",0,1,"+f+","+(this._x1=h)+","+(this._y1=d):g>1e-6&&(this._+="A"+n+","+n+",0,"+ +(g>=i)+","+f+","+(this._x1=t+n*Math.cos(a))+","+(this._y1=e+n*Math.sin(a))))},rect:function(t,e,n,i){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +i+"h"+-n+"Z"},toString:function(){return this._}};var l=a,c={name:"GoBoard",props:{board:{type:Array,default:function(){return[]}},playerTurn:{type:Number,default:-1},allowedActions:{type:Array,default:function(){return[]}},rows:{type:Number,default:19,validator:function(t){return Number.isInteger(t)&&t>=2}},cols:{type:Number,default:19,validator:function(t){return Number.isInteger(t)&&t>=2}},svgWidth:{type:Number,default:1024,validator:function(t){return t>=1}},svgHeight:{type:Number,default:1024,validator:function(t){return t>=1}}},data:function(){return{focus:-1}},computed:{svgViewBox:function(){return"0 0 ".concat(this.svgWidth," ").concat(this.svgHeight)},stoneRadius:function(){return.35*Math.min(this.svgWidth/this.cols,this.svgHeight/this.rows)|0},dxs:function(){var t=this.rows*this.cols;return Array.from({length:t},function(){return 10*Math.random()-5|0})},dys:function(){var t=this.rows*this.cols;return Array.from({length:t},function(){return 10*Math.random()-5|0})},gridPath:function(){for(var t=this.svgWidth,e=this.svgHeight,n=this.rows,i=this.cols,o=t/n,s=e/i,r=o/2|0,a=s/2|0,c=t-o/2|0,u=e-s/2|0,h=l(),d=0;d<i;++d){var f=r+d*o|0;h.moveTo(f,a),h.lineTo(f,u)}for(var g=0;g<n;++g){var p=a+g*s|0;h.moveTo(r,p),h.lineTo(c,p)}return h.toString()}},watch:{allowedActions:function(){this.focus=-1}},methods:{onMouseMove:function(t){var e=Number(t.target.dataset.action||"-1");this.focus!==e&&this.allowedActions.includes(e)&&(this.focus=e)},onClick:function(t){var e=Number(t.target.dataset.action||"-1");this.allowedActions.includes(e)&&this.$emit("putstone",e)},index:function(t,e){return this.cols*(e-1)+(t-1)},stoneClass:function(t,e){var n=this.index(t,e),i=this.focus===n,o=i?this.playerTurn:this.board[n];return{"go-board-stone":!0,"go-board-stone-black":0===o,"go-board-stone-white":1===o,"go-board-stone-focus":i}},fx:function(t,e){return t+this.dxs[e]|0},fy:function(t,e){return t+this.dys[e]|0}}},u=(n(189),n(0)),h=Object(u.a)(c,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("svg",{staticClass:"go-board-root",attrs:{viewBox:t.svgViewBox},on:{mousemove:t.onMouseMove,click:function(e){return"button"in e||!t._k(e.keyCode,"left",37,e.key,["Left","ArrowLeft"])?"button"in e&&0!==e.button?null:t.onClick(e):null}}},[n("path",{attrs:{d:t.gridPath,fill:"none",stroke:"#000","stroke-width":"2","stroke-linecap":"butt"}}),t._l(t.rows,function(e){return t._l(t.cols,function(i){return n("circle",{key:"R"+e+"C"+i,class:t.stoneClass(i,e),attrs:{"data-action":t.index(i,e),cx:t.fx((i-.5)*t.svgWidth/t.cols,i),cy:t.fy((e-.5)*t.svgHeight/t.rows,e),r:t.stoneRadius}})})})],2)},[],!1,null,null,null);e.default=h.exports},219:function(t,e,n){"use strict";var i=n(171);n.n(i).a},304:function(t,e,n){"use strict";var i=n(45),o=n(76),s=n(54);t.exports=function(t){for(var e=i(this),n=s(e.length),r=arguments.length,a=o(r>1?arguments[1]:void 0,n),l=r>2?arguments[2]:void 0,c=void 0===l?n:o(l,n);c>a;)e[a++]=t;return e}},305:function(t,e,n){var i=n(19);i(i.P,"Array",{fill:n(304)}),n(66)("fill")},319:function(t,e,n){"use strict";n.r(e);n(188),n(167),n(166),n(187),n(305);var i=n(186),o=n(157),s=n(168),r=n(158),a=n(195),l=n(197);var c,u,h=new o.c(s.a),d={name:"GomokuPlayground",components:{AgentConfig:a.default,GoBoard:l.default},data:function(){return{weights:s.b,black:{manual:!0,weights:void 0,depth:5},white:{manual:!1,weights:s.b[s.b.length-1],depth:5},isPlaying:!1,abortController:null,message:"",board:new Array(s.a.rows*s.a.cols).fill(-1),playerTurn:-1,allowedActions:[],sendAction:null,abortAction:null}},computed:{cols:function(){return s.a.cols},rows:function(){return s.a.rows}},beforeDestroy:function(){this.abort()},methods:{play:(c=regeneratorRuntime.mark(function t(){var e,n,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.isPlaying=!0,this.abortController=new i.AbortController,t.prev=2,e=this.createPlayer(this.black),n=this.createPlayer(this.white),t.next=7,h.play({players:[e,n],signal:this.abortController.signal,onThinkStart:this.onThinkStart});case 7:o=t.sent,this.board=o.board.slice(0),this.playerTurn=-1,this.allowedActions=[],this.message=0===o.winner?"黒番の勝ちです。":1===o.winner?"白番の勝ちです。":"引き分けです。",t.next=17;break;case 14:t.prev=14,t.t0=t.catch(2),"aborted"===t.t0.message?this.message="中止しました。":this.message="エラーが発生しました。\n".concat(t.t0.message);case 17:return t.prev=17,this.isPlaying=!1,this.abortController=null,t.finish(17);case 21:case"end":return t.stop()}},t,this,[[2,14,17,21]])}),u=function(){var t=this,e=arguments;return new Promise(function(n,i){var o=c.apply(t,e);function s(t,e){try{var s=o[t](e),l=s.value}catch(t){return void i(t)}s.done?n(l):Promise.resolve(l).then(r,a)}function r(t){s("next",t)}function a(t){s("throw",t)}r()})},function(){return u.apply(this,arguments)}),abort:function(){this.abortAction&&this.abortAction(),this.abortController&&this.abortController.abort()},createPlayer:function(t){return t.manual?new o.b(this.onPlayerActionStart):new o.a({rule:s.a,serializedModel:t.weights,maxThinkingTime:{type:"count",value:t.depth}})},onPlayerActionStart:function(t,e,n){var i=this;this.message="あなたの番です。",this.board=t.board.slice(0),this.playerTurn=t.playerTurn,this.allowedActions=t.actions.slice(0),this.sendAction=function(n){i.playerTurn=-1,i.allowedActions=[],i.sendAction=null,i.abortAction=null,e(s.a.takeAction(t,n))},this.abortAction=function(){i.playerTurn=-1,i.allowedActions=[],i.sendAction=null,i.abortAction=null,n(new Error("aborted"))}},onThinkStart:function(t){if(!(0===t.playerTurn?this.black:this.white).manual)return this.board=t.board.slice(0),this.message="AlphaZero 思考中...",Object(r.a)()},onPutStone:function(t){this.sendAction&&this.allowedActions.includes(t)&&this.sendAction(t)}}},f=(n(219),n(0)),g=Object(f.a)(d,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"gomoku-playground-root"},[n("div",{staticClass:"gomoku-playground-settings"},[n("agent-config",{staticClass:"gomoku-playground-agent-config",attrs:{weights:t.weights,disabled:t.isPlaying},model:{value:t.black,callback:function(e){t.black=e},expression:"black"}}),n("agent-config",{staticClass:"gomoku-playground-agent-config",attrs:{weights:t.weights,disabled:t.isPlaying},model:{value:t.white,callback:function(e){t.white=e},expression:"white"}}),n("div",[t.isPlaying?n("button",{on:{click:t.abort}},[t._v("❌ 中止する")]):n("button",{on:{click:t.play}},[t._v("▶️ 開始する")]),n("span",{directives:[{name:"show",rawName:"v-show",value:t.message,expression:"message"}],staticClass:"gomoku-playground-message"},[t._v(t._s(t.message))])])],1),n("go-board",{attrs:{board:t.board,"player-turn":t.playerTurn,"allowed-actions":t.allowedActions,rows:t.rows,cols:t.cols},on:{putstone:t.onPutStone}})],1)},[],!1,null,null,null);e.default=g.exports}}]);